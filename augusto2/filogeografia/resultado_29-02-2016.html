<!DOCTYPE html>
<!--
    Autor: Augusto C. A. Ribas
  -->
<html>
  <head>
    <title>Resultado 29/02/2016</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../estilo.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <h1>Resultado 29/02/2016</h1>
    <div class="relatorio">


      <h2>Índice</h2>
      <ul>
	<li><a href="#sec1">Árvores com reconstrução ancestral</a> </li>
	<li><a href="#sec2">Probabilidade do local na raiz</a> </li>
	<li><a href="#sec3">Animação do spread da tuberculose</a> </li>
	<li><a href="#sec4">Reconstrução ancestral da sequência</a> </li>
	<li><a href="#sec5">O que fazer a partir daqui</a> </li>
	
      </ul>

      <h3 id="sec1">Árvores com reconstrução ancestral</h3>


      <p>Aqui é a árvore mais provável (com maior verossimilhança) </p>
      <img src="arvore1.png" alt="Árvore 1">

      <p>Depois são apenas duas outras formas de apresentação.</p>      
      <img src="arvore2.png" alt="Árvore 2"  width="480"> <img src="arvore3.png" alt="Árvore 3" width="480">

      <h3 id="sec2">Probabilidade do local na raiz </h3>
      <p>Mais, lembrando que não definimos uma raiz a priori, isso vem da reconstrução ancestral. A cada duas linhagens, em algum momento
      elas devem ter tido um ancestral em comum, o tempo até esse evento é o tempo para coalescer</p>
      <p>Podemos calcular as probabilidades associada ao vértice mais ancestral (quando todas nossas linhagem coalescem), aqui o resultado
	ficou ruim.</p>

      <pre>
      <p style="font-family: courier new,monospace;">
                       Var1       Freq
	1             Acre_Brasil 0.10196455
	2  Buenos_Aires_Argentina 0.09499520
	3      La_Pampa_Argentina 0.09125802
	4     Minas_Gerais_Brasil 0.11070148
	5               MS_Brasil 0.10262108
	6           Parana_Brasil 0.10100500
	7      Santa_Fe_Argentina 0.09024797
	8        Sao_Paulo_Brasil 0.12211504
	9          United_Kingdom 0.08954093
	10      Weybridge_England 0.09560123
      </p>
      </pre>

      <p>O ruim é que temos pouca certeza de qualquer coisa. Esse resultado é na verdade uma cadeia de markov, onde para cada iteração,
	definimos um estado, nesse caso, a gente ta tendo algo assim:</p>

      <img src="01.jpg" alt="Markoc chain - mbovis">

      <p>Ou seja, a gente não está estacionando em nenhum estado, em nenhum local, para comparar, da para olhar para a mesma figura do
	exemplo com h1n1</p>

      <img src="teste01.jpg" alt="Markoc chain - mbovis">

      <p>Veja que algum lugares nunca são visitados na cadeia, além disso, a probabilidade de HongKong sempre ser visitada, implica no
	fato de que que podemos ter uma precisão aceitavel de inferir qual a origem desse anestral nesse momento. </p>


      <p>Resumindo, o resultado não ficou bom. Mas podemos ter uma ideia de que tipo de informção vamos ver.</p>

      <h3 id="sec3">Animação do spread da tuberculose</h3>
      
      <p>A informação do modelo pode ser usada também espacialmente para gerar visualização do "spread" da doença. Mas que não é
      muito confiavel ainda</p>
      <img src="teste.gif" alt="teste.gif">

      <h3 id="sec4">Reconstrução ancestral da sequência</h3>
      <p>Além disso, uma outra informação, que pode ser muito interessante, é que além dos locais (que são um trait discreto), reconstruimos
	as sequências de entradas. A principio, eu estou salvando a reconstrução do ancestral que deve ser a "raiz", mas da para salvar o
	resultado para cada um dos ancestrais. Essa reconstrução esta no arquivo</br>
	<strong>"/home/bio/projects/augusto/filogeografia/beast/mbobis_skyride_ucld_discrete.alinhamento_com_anos.states.log"</strong>.</br>
	Agora essa rescontrução pode ser interessante, para além de acompanha as linhagens, como a gente sabe, cada uma das bases, de onde
	ela vem, de qual gene ela vem, so pensar no indice que veio do gblocks e antes de usar o gblocks, o vcf. Mas talvez poderiamos
	acompanhar a parte alguns genes de interesse, por exemplo, os que podem vir a causar a virulência no 04303.
      </p>

      <p>Se for olhar o arquivo, ele ta organizado assim: </p>

      <pre>
      <p style="font-family: courier new,monospace;">
      49997500"GGTCGGTCGCGCGC...AAGC"      
      50000000"GGTCGGTCGCGCGC...AAGC"
      </p>
      </pre>


      <p>O número é a posição na cadeia, e nos fizemos 50000000, salvando a cada 2500 passos. So temos que tomar cuidado para não salvar
	informação demais.</p>

      <img src="beauti1.png" alt="Beauti 1"  width="800"> 


      <p>Além disso eu so salvei a raiz para ver como ficava, mas como podemos ver na tela do modelo, podemos salvar
      o estado de os ancestrais, e isso talvéz possa ser usada, como comentei, para acompanhar alguns genes de interesse, o que pode ser
	um resultado interessante.</p>

      <img src="beauti2.png" alt="Beauti 2"  width="800">

      <p> Todas as opções que eu usei estão salvas no arquivo model_especification.xml na pasta
	/home/bio/projects/augusto/filogeografia/beast </p>

      <h3 id="sec5">O que fazer a partir daqui</h3>
      <p>Eu acho que para melhorar o modelo podemos tentar o seguinte</p>
      
      <ul>

	<li>Aumentar o número de sequências, pegando mais genomas completos depositadas no genbank, podemos pegar sequências completas
	  com localização e ano de isolamento, usando um script de python, e a partir do fasta do genoma, comparando com o referência a
	  gente gera um vcf, e ai usar esses vcfs em conjunto com o que ja temos.</li>

	<li>Para aumentar as amostras por local, podemos abandonar a informação do estado brasileiro e usar somente o pais como local, assim
	ficamos com uma especificidade menor, mas mais repetições por unidade amostral</li>

	<li>Podemos tentar usar as localizações como uma caracteristica continua, como nesse exemplo
	  <a href="http://beast.bio.ed.ac.uk/continuous-phylogeographic-analysis">aqui<a> </li>
	
      </ul>      
      
    </div>

    <footer>
      <p><a href="index.html">Projeto - Filogeografia</a>  <a href="../../?op=inicio">Início</a></p>
    </footer>
    
  </body>
</html>

