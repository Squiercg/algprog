<!DOCTYPE html>

<html>
  <head>
    <title>Reunião 26/02/2016</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>

    <div>

      <h1>Reunião 26/02/2016</h1>


      <ul>
	<li>Objetivo: usar o modelo de filogeografia para determinar o spread do Mbovis no tempo e espaço</li>
	<ul>
	  <li>pretendemos fazer isso usando o <a href="http://www.ncbi.nlm.nih.gov/pubmed/17996036">Beast</a></li>
	  <li><a href="http://jau.facom.ufms.br/augusto/View/filogeografia/cmaptools/2009%20-%20Lemey%20-%20Bayesian%20Phylogeography%20Finds%20Its%20Roots.pdf">aqui</a> temos uma explicação de como se usa o modelo</li>
	  <li>exemplos de uso:</li>
	  <ul>
	    <li>um exemplo de uso: <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2762761/">Reconstructing the initial global spread of a human influenza pandemic</a>
	    <li><a href="http://jau.facom.ufms.br/augusto/View/filogeografia/cmaptools/2016%20-%20Holden%20-%20A%20genomic%20portrait%20of%20the%20emergence,%20evolution,and%20global%20spread%20of%20a%20methicillin-resistantStaphylococcus%20aureus%20pandemic.pdf">bacteria</a></li>


	  </ul>

	  <li>Entrada: um alinhamento das sequencias representativas das espécies; ano e local de origem do isolado</li>
	  <li>saída: árvores, relógio molecular, local provável do ancestral</li>
	  <li>adicionalmente, podemos usar um pacote do beast que usa a árvore, mais as coordenadas geodésicas e o google desenha o mapa</li>


	  <li>Resultados para 18 M.bovis (17 nossos + AF2122)</li>
	  <ul>
	    <li>Árvore com reconstrução ancestral</li>
	    <img src="../filogeografia/arvore1.png" alt="Árvore 1">
	    <li>Linhagens ao longo do tempo</li>
	    <img src="../filogeografia/teste.gif" alt="teste">
	    <li>Os resultados foram resumidos na <a href="../filogeografia/resultado_29-02-2016.html">página do projeto de filogeografia</a>.</li>
	  </ul>


	  
	</ul>

	

	

        <h2>Alinhamento Múltiplo</h2>
	
        <h3>Dúvidas</h3>
        <ul>
          <li>Mais de um snp possível para uma mesma posição?</li>    

          <p style="font-family: courier new,monospace;">cat MBAN5_variants.vcf | grep "3880368"</br>
            gi|31791177|ref|NC_002945.3|	3880368	.	T	G	55.0072	.</br>	
            gi|31791177|ref|NC_002945.3|	3880368	.	TGACGG	TGACGGTGGGGACGG	217.469	.</p>	

          <li>Mais de uma possibilidade para o ocorrido</li>
          <p style="font-family: courier new,monospace;">cat MB04303_variants.vcf  | grep "21878"</br>
            gi|31791177|ref|NC_002945.3|	21878	.	GCCC	GC,GCC	5.08359	</p>


          <li>Exemplo de artigos usando modelo do Lemey 2009 (Beast)</li>
          <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2762761/">Reconstructing the initial global spread of a human influenza pandemic</a>

          <li>Usar dados do Genbank</li>

          Usando um script python, a gente pode pegar genomas depositados do genbank

          <p style="font-family: courier new,monospace;">
            from Bio import Entrez, SeqIO</br>
            import re</br>
            Entrez.email = "ribas.aca@gmail.com"</br>
            handle = Entrez.esearch(db="nucleotide",retmax=400,term='Mycobacterium bovis AND ("4000000"[SLEN] : "5000000"[SLEN])',)</br>
            handle.close()</br>
            print record["Count"]</br>
            >>> 464
          </p>

          Depois convertemos fasta para vcf

          <a href="https://github.com/pomo-dev/PoMo">Fasta to VCF</a>

          E conferir quais tem dados suficientes para usarmos
          <p style="font-family: courier new,monospace;">
            FEATURES             Location/Qualifiers</br>
            source          1..4426489</br>
            /organism="Mycobacterium tuberculosis"</br>
            /mol_type="genomic DNA"</br>
            /strain="26105"</br>
            /isolation_source="Human sputum"</br>
            /db_xref="taxon:1773"</br>
            /country="China"</br>
            /collection_date="2007-04-01"</br>
          </p>

          <p style="font-family: courier new,monospace;">                    
            handle = Entrez.efetch(db="nucleotide", id=lista[0], rettype="gb", retmode="text")</br>
            texto=handle.read()</br>
            handle.close()</br>
                    </br>
                    p = re.compile('/country="(.*)"')</br>
                    busca=p.search(texto) </br>  
                    print busca.group(1)</br>
                    >>>China</br>
                    </br>
                    p = re.compile('/collection_date="(.*)"')</br>
                    busca=p.search(texto)</br>   
                    print busca.group(1)</br>
                    >>>2007-04-01</br>
          </p>


          <li>Exemplo de Saida</li>


          <p><img src="H5N1_00.png" alt="Árvore" width="480" height="480"></p>

          <p><img src="H5N1_01.png" alt="Árvore" width="480" height="480"></p>

          <p style="font-family: courier new,monospace;">
            Var1        Freq</br>
            1    Fujian 0.053858967</br>
            2 Guangdong 0.138256524</br>
            3   Guangxi 0.145474736</br>
            4     Hebei 0.003331483</br>
            5     Henan 0.001665741</br>
            6  HongKong 0.655746807</br>
            7     Hunan 0.002220988</br>
          </p>






        </ul>

    </div>

    <ul>
      <li>tarefas:</li>
      <ul>
	<li>beast</li>
	<ul>
	  <li>Rodar o beast para as 18 cepas
	  <li>mostrar a árvore e o mapa (google)
	</ul>
	<li>site</li>
	<ul>
	  <li>montar o site do projeto da fundect (jau.facom.ufms.br/augusto/mbovis)
	  <li> titulo, objetivos, equipe, funding, logo da facom, da umfs
	  <li> 	    </ul>
	
      </ul>
    </ul>



    
    <footer>
      <p>Navegação</p>
      <p><a href="../index.html">Início</a> <a href="index.html">Lista de reuniões</a></p>
    </footer>
    
  </body>


</html>
